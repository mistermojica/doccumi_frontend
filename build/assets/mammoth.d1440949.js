import{c as Fe}from"./@ckeditor.245690c7.js";import{r as tu}from"./crypto-extra.ec615c51.js";import{p as ru}from"./bluebird.c45a2433.js";import{j as nu}from"./jszip.06ff3fe0.js";import{s as au}from"./sax.0e14931f.js";import{l as uu}from"./xmlbuilder.545a9769.js";import{d as iu}from"./dingbat-to-unicode.24fc60d8.js";import{u as ou}from"./util.87ec2436.js";import{l as $n}from"./lop.8865af24.js";var z={exports:{}};(function(e,r){(function(u,s){e.exports=s()})(Fe,function(){var u="1.13.6",s=typeof self=="object"&&self.self===self&&self||typeof Fe=="object"&&Fe.global===Fe&&Fe||Function("return this")()||{},p=Array.prototype,h=Object.prototype,y=typeof Symbol<"u"?Symbol.prototype:null,w=p.push,b=p.slice,v=h.toString,T=h.hasOwnProperty,I=typeof ArrayBuffer<"u",X=typeof DataView<"u",Z=Array.isArray,C=Object.keys,O=Object.create,j=I&&ArrayBuffer.isView,K=isNaN,ge=isFinite,we=!{toString:null}.propertyIsEnumerable("toString"),Ee=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],q=Math.pow(2,53)-1;function H(t,n){return n=n==null?t.length-1:+n,function(){for(var a=Math.max(arguments.length-n,0),i=Array(a),l=0;l<a;l++)i[l]=arguments[l+n];switch(n){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i);case 2:return t.call(this,arguments[0],arguments[1],i)}var o=Array(n+1);for(l=0;l<n;l++)o[l]=arguments[l];return o[n]=i,t.apply(this,o)}}function ee(t){var n=typeof t;return n==="function"||n==="object"&&!!t}function Pe(t){return t===void 0}function xe(t){return t===!0||t===!1||v.call(t)==="[object Boolean]"}function U(t){var n="[object "+t+"]";return function(a){return v.call(a)===n}}var G=U("String"),He=U("Number"),Ke=U("Date"),De=U("RegExp"),Ge=U("Error"),qe=U("Symbol"),We=U("ArrayBuffer"),d=U("Function"),S=s.document&&s.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof S!="function"&&(d=function(t){return typeof t=="function"||!1});var E=d,P=U("Object"),_=X&&P(new DataView(new ArrayBuffer(8))),M=typeof Map<"u"&&P(new Map),Y=U("DataView"),ae=_?function(t){return t!=null&&E(t.getInt8)&&We(t.buffer)}:Y,te=Z||U("Array");function c(t,n){return t!=null&&T.call(t,n)}var g=U("Arguments");(function(){g(arguments)||(g=function(t){return c(t,"callee")})})();var k=g;function B(t){return He(t)&&K(t)}function W(t){return function(){return t}}function L(t){return function(n){var a=t(n);return typeof a=="number"&&a>=0&&a<=q}}function ue(t){return function(n){return n?.[t]}}var Se=ue("byteLength"),st=L(Se),ka=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,Er=I?function(t){return j?j(t)&&!ae(t):st(t)&&ka.test(v.call(t))}:W(!1),le=ue("length");function Sr(t,n){n=function(f){for(var m={},R=f.length,N=0;N<R;++N)m[f[N]]=!0;return{contains:function(D){return m[D]===!0},push:function(D){return m[D]=!0,f.push(D)}}}(n);var a=Ee.length,i=t.constructor,l=E(i)&&i.prototype||h,o="constructor";for(c(t,o)&&!n.contains(o)&&n.push(o);a--;)(o=Ee[a])in t&&t[o]!==l[o]&&!n.contains(o)&&n.push(o)}function J(t){if(!ee(t))return[];if(C)return C(t);var n=[];for(var a in t)c(t,a)&&n.push(a);return we&&Sr(t,n),n}function kr(t,n){var a=J(n),i=a.length;if(t==null)return!i;for(var l=Object(t),o=0;o<i;o++){var f=a[o];if(n[f]!==l[f]||!(f in l))return!1}return!0}function F(t){return t instanceof F?t:this instanceof F?void(this._wrapped=t):new F(t)}function Rr(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,Se(t))}F.VERSION=u,F.prototype.value=function(){return this._wrapped},F.prototype.valueOf=F.prototype.toJSON=F.prototype.value,F.prototype.toString=function(){return String(this._wrapped)};var Ir="[object DataView]";function $t(t,n,a,i){if(t===n)return t!==0||1/t==1/n;if(t==null||n==null)return!1;if(t!=t)return n!=n;var l=typeof t;return(l==="function"||l==="object"||typeof n=="object")&&function o(f,m,R,N){f instanceof F&&(f=f._wrapped),m instanceof F&&(m=m._wrapped);var D=v.call(f);if(D!==v.call(m))return!1;if(_&&D=="[object Object]"&&ae(f)){if(!ae(m))return!1;D=Ir}switch(D){case"[object RegExp]":case"[object String]":return""+f==""+m;case"[object Number]":return+f!=+f?+m!=+m:+f==0?1/+f==1/m:+f==+m;case"[object Date]":case"[object Boolean]":return+f==+m;case"[object Symbol]":return y.valueOf.call(f)===y.valueOf.call(m);case"[object ArrayBuffer]":case Ir:return o(Rr(f),Rr(m),R,N)}var ie=D==="[object Array]";if(!ie&&Er(f)){if(Se(f)!==Se(m))return!1;if(f.buffer===m.buffer&&f.byteOffset===m.byteOffset)return!0;ie=!0}if(!ie){if(typeof f!="object"||typeof m!="object")return!1;var Me=f.constructor,$e=m.constructor;if(Me!==$e&&!(E(Me)&&Me instanceof Me&&E($e)&&$e instanceof $e)&&"constructor"in f&&"constructor"in m)return!1}N=N||[];for(var be=(R=R||[]).length;be--;)if(R[be]===f)return N[be]===m;if(R.push(f),N.push(m),ie){if((be=f.length)!==m.length)return!1;for(;be--;)if(!$t(f[be],m[be],R,N))return!1}else{var mt,sn=J(f);if(be=sn.length,J(m).length!==be)return!1;for(;be--;)if(mt=sn[be],!c(m,mt)||!$t(f[mt],m[mt],R,N))return!1}return R.pop(),N.pop(),!0}(t,n,a,i)}function Ye(t){if(!ee(t))return[];var n=[];for(var a in t)n.push(a);return we&&Sr(t,n),n}function At(t){var n=le(t);return function(a){if(a==null)return!1;var i=Ye(a);if(le(i))return!1;for(var l=0;l<n;l++)if(!E(a[t[l]]))return!1;return t!==Nr||!E(a[Ft])}}var Ft="forEach",Or="has",jt=["clear","delete"],Pr=["get",Or,"set"],Ra=jt.concat(Ft,Pr),Nr=jt.concat(Pr),Ia=["add"].concat(jt,Ft,Or),Oa=M?At(Ra):U("Map"),Pa=M?At(Nr):U("WeakMap"),Na=M?At(Ia):U("Set"),_a=U("WeakSet");function Le(t){for(var n=J(t),a=n.length,i=Array(a),l=0;l<a;l++)i[l]=t[n[l]];return i}function _r(t){for(var n={},a=J(t),i=0,l=a.length;i<l;i++)n[t[a[i]]]=a[i];return n}function Ht(t){var n=[];for(var a in t)E(t[a])&&n.push(a);return n.sort()}function Dt(t,n){return function(a){var i=arguments.length;if(n&&(a=Object(a)),i<2||a==null)return a;for(var l=1;l<i;l++)for(var o=arguments[l],f=t(o),m=f.length,R=0;R<m;R++){var N=f[R];n&&a[N]!==void 0||(a[N]=o[N])}return a}}var Br=Dt(Ye),ft=Dt(J),Cr=Dt(Ye,!0);function Mr(t){if(!ee(t))return{};if(O)return O(t);var n=function(){};n.prototype=t;var a=new n;return n.prototype=null,a}function $r(t){return te(t)?t:[t]}function Je(t){return F.toPath(t)}function qt(t,n){for(var a=n.length,i=0;i<a;i++){if(t==null)return;t=t[n[i]]}return a?t:void 0}function Ar(t,n,a){var i=qt(t,Je(n));return Pe(i)?a:i}function Wt(t){return t}function Qe(t){return t=ft({},t),function(n){return kr(n,t)}}function Lt(t){return t=Je(t),function(n){return qt(n,t)}}function et(t,n,a){if(n===void 0)return t;switch(a??3){case 1:return function(i){return t.call(n,i)};case 3:return function(i,l,o){return t.call(n,i,l,o)};case 4:return function(i,l,o,f){return t.call(n,i,l,o,f)}}return function(){return t.apply(n,arguments)}}function Fr(t,n,a){return t==null?Wt:E(t)?et(t,n,a):ee(t)&&!te(t)?Qe(t):Lt(t)}function Xt(t,n){return Fr(t,n,1/0)}function se(t,n,a){return F.iteratee!==Xt?F.iteratee(t,n):Fr(t,n,a)}function jr(){}function Ut(t,n){return n==null&&(n=t,t=0),t+Math.floor(Math.random()*(n-t+1))}F.toPath=$r,F.iteratee=Xt;var tt=Date.now||function(){return new Date().getTime()};function Hr(t){var n=function(o){return t[o]},a="(?:"+J(t).join("|")+")",i=RegExp(a),l=RegExp(a,"g");return function(o){return o=o==null?"":""+o,i.test(o)?o.replace(l,n):o}}var Dr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Ba=Hr(Dr),Ca=Hr(_r(Dr)),Ma=F.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Vt=/(.)^/,$a={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Aa=/\\|'|\r|\n|\u2028|\u2029/g;function Fa(t){return"\\"+$a[t]}var ja=/^\s*(\w|\$)+\s*$/,Ha=0;function qr(t,n,a,i,l){if(!(i instanceof n))return t.apply(a,l);var o=Mr(t.prototype),f=t.apply(o,l);return ee(f)?f:o}var Xe=H(function(t,n){var a=Xe.placeholder,i=function(){for(var l=0,o=n.length,f=Array(o),m=0;m<o;m++)f[m]=n[m]===a?arguments[l++]:n[m];for(;l<arguments.length;)f.push(arguments[l++]);return qr(t,i,this,this,f)};return i});Xe.placeholder=F;var Wr=H(function(t,n,a){if(!E(t))throw new TypeError("Bind must be called on a function");var i=H(function(l){return qr(t,i,n,this,a.concat(l))});return i}),me=L(le);function Be(t,n,a,i){if(i=i||[],n||n===0){if(n<=0)return i.concat(t)}else n=1/0;for(var l=i.length,o=0,f=le(t);o<f;o++){var m=t[o];if(me(m)&&(te(m)||k(m)))if(n>1)Be(m,n-1,a,i),l=i.length;else for(var R=0,N=m.length;R<N;)i[l++]=m[R++];else a||(i[l++]=m)}return i}var Da=H(function(t,n){var a=(n=Be(n,!1,!1)).length;if(a<1)throw new Error("bindAll must be passed function names");for(;a--;){var i=n[a];t[i]=Wr(t[i],t)}return t}),Lr=H(function(t,n,a){return setTimeout(function(){return t.apply(null,a)},n)}),qa=Xe(Lr,F,1);function zt(t){return function(){return!t.apply(this,arguments)}}function Xr(t,n){var a;return function(){return--t>0&&(a=n.apply(this,arguments)),t<=1&&(n=null),a}}var Wa=Xe(Xr,2);function Ur(t,n,a){n=se(n,a);for(var i,l=J(t),o=0,f=l.length;o<f;o++)if(n(t[i=l[o]],i,t))return i}function Vr(t){return function(n,a,i){a=se(a,i);for(var l=le(n),o=t>0?0:l-1;o>=0&&o<l;o+=t)if(a(n[o],o,n))return o;return-1}}var Zt=Vr(1),zr=Vr(-1);function Zr(t,n,a,i){for(var l=(a=se(a,i,1))(n),o=0,f=le(t);o<f;){var m=Math.floor((o+f)/2);a(t[m])<l?o=m+1:f=m}return o}function Kr(t,n,a){return function(i,l,o){var f=0,m=le(i);if(typeof o=="number")t>0?f=o>=0?o:Math.max(o+m,f):m=o>=0?Math.min(o+1,m):o+m+1;else if(a&&o&&m)return i[o=a(i,l)]===l?o:-1;if(l!=l)return(o=n(b.call(i,f,m),B))>=0?o+f:-1;for(o=t>0?f:m-1;o>=0&&o<m;o+=t)if(i[o]===l)return o;return-1}}var Gr=Kr(1,Zt,Zr),La=Kr(-1,zr);function Kt(t,n,a){var i=(me(t)?Zt:Ur)(t,n,a);if(i!==void 0&&i!==-1)return t[i]}function ke(t,n,a){var i,l;if(n=et(n,a),me(t))for(i=0,l=t.length;i<l;i++)n(t[i],i,t);else{var o=J(t);for(i=0,l=o.length;i<l;i++)n(t[o[i]],o[i],t)}return t}function Ce(t,n,a){n=se(n,a);for(var i=!me(t)&&J(t),l=(i||t).length,o=Array(l),f=0;f<l;f++){var m=i?i[f]:f;o[f]=n(t[m],m,t)}return o}function Yr(t){var n=function(a,i,l,o){var f=!me(a)&&J(a),m=(f||a).length,R=t>0?0:m-1;for(o||(l=a[f?f[R]:R],R+=t);R>=0&&R<m;R+=t){var N=f?f[R]:R;l=i(l,a[N],N,a)}return l};return function(a,i,l,o){var f=arguments.length>=3;return n(a,et(i,o,4),l,f)}}var Gt=Yr(1),Jr=Yr(-1);function Ue(t,n,a){var i=[];return n=se(n,a),ke(t,function(l,o,f){n(l,o,f)&&i.push(l)}),i}function Qr(t,n,a){n=se(n,a);for(var i=!me(t)&&J(t),l=(i||t).length,o=0;o<l;o++){var f=i?i[o]:o;if(!n(t[f],f,t))return!1}return!0}function en(t,n,a){n=se(n,a);for(var i=!me(t)&&J(t),l=(i||t).length,o=0;o<l;o++){var f=i?i[o]:o;if(n(t[f],f,t))return!0}return!1}function Re(t,n,a,i){return me(t)||(t=Le(t)),(typeof a!="number"||i)&&(a=0),Gr(t,n,a)>=0}var Xa=H(function(t,n,a){var i,l;return E(n)?l=n:(n=Je(n),i=n.slice(0,-1),n=n[n.length-1]),Ce(t,function(o){var f=l;if(!f){if(i&&i.length&&(o=qt(o,i)),o==null)return;f=o[n]}return f==null?f:f.apply(o,a)})});function Yt(t,n){return Ce(t,Lt(n))}function tn(t,n,a){var i,l,o=-1/0,f=-1/0;if(n==null||typeof n=="number"&&typeof t[0]!="object"&&t!=null)for(var m=0,R=(t=me(t)?t:Le(t)).length;m<R;m++)(i=t[m])!=null&&i>o&&(o=i);else n=se(n,a),ke(t,function(N,D,ie){((l=n(N,D,ie))>f||l===-1/0&&o===-1/0)&&(o=N,f=l)});return o}var Ua=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function rn(t){return t?te(t)?b.call(t):G(t)?t.match(Ua):me(t)?Ce(t,Wt):Le(t):[]}function nn(t,n,a){if(n==null||a)return me(t)||(t=Le(t)),t[Ut(t.length-1)];var i=rn(t),l=le(i);n=Math.max(Math.min(n,l),0);for(var o=l-1,f=0;f<n;f++){var m=Ut(f,o),R=i[f];i[f]=i[m],i[m]=R}return i.slice(0,n)}function ct(t,n){return function(a,i,l){var o=n?[[],[]]:{};return i=se(i,l),ke(a,function(f,m){var R=i(f,m,a);t(o,f,R)}),o}}var Va=ct(function(t,n,a){c(t,a)?t[a].push(n):t[a]=[n]}),za=ct(function(t,n,a){t[a]=n}),Za=ct(function(t,n,a){c(t,a)?t[a]++:t[a]=1}),Ka=ct(function(t,n,a){t[a?0:1].push(n)},!0);function Ga(t,n,a){return n in a}var an=H(function(t,n){var a={},i=n[0];if(t==null)return a;E(i)?(n.length>1&&(i=et(i,n[1])),n=Ye(t)):(i=Ga,n=Be(n,!1,!1),t=Object(t));for(var l=0,o=n.length;l<o;l++){var f=n[l],m=t[f];i(m,f,t)&&(a[f]=m)}return a}),Ya=H(function(t,n){var a,i=n[0];return E(i)?(i=zt(i),n.length>1&&(a=n[1])):(n=Ce(Be(n,!1,!1),String),i=function(l,o){return!Re(n,o)}),an(t,i,a)});function un(t,n,a){return b.call(t,0,Math.max(0,t.length-(n==null||a?1:n)))}function Jt(t,n,a){return t==null||t.length<1?n==null||a?void 0:[]:n==null||a?t[0]:un(t,t.length-n)}function pt(t,n,a){return b.call(t,n==null||a?1:n)}var on=H(function(t,n){return n=Be(n,!0,!0),Ue(t,function(a){return!Re(n,a)})}),Ja=H(function(t,n){return on(t,n)});function Qt(t,n,a,i){xe(n)||(i=a,a=n,n=!1),a!=null&&(a=se(a,i));for(var l=[],o=[],f=0,m=le(t);f<m;f++){var R=t[f],N=a?a(R,f,t):R;n&&!a?(f&&o===N||l.push(R),o=N):a?Re(o,N)||(o.push(N),l.push(R)):Re(l,R)||l.push(R)}return l}var Qa=H(function(t){return Qt(Be(t,!0,!0))});function er(t){for(var n=t&&tn(t,le).length||0,a=Array(n),i=0;i<n;i++)a[i]=Yt(t,i);return a}var eu=H(er);function tr(t,n){return t._chain?F(n).chain():n}function ln(t){return ke(Ht(t),function(n){var a=F[n]=t[n];F.prototype[n]=function(){var i=[this._wrapped];return w.apply(i,arguments),tr(this,a.apply(F,i))}}),F}ke(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=p[t];F.prototype[t]=function(){var a=this._wrapped;return a!=null&&(n.apply(a,arguments),t!=="shift"&&t!=="splice"||a.length!==0||delete a[0]),tr(this,a)}}),ke(["concat","join","slice"],function(t){var n=p[t];F.prototype[t]=function(){var a=this._wrapped;return a!=null&&(a=n.apply(a,arguments)),tr(this,a)}});var rr=ln({__proto__:null,VERSION:u,restArguments:H,isObject:ee,isNull:function(t){return t===null},isUndefined:Pe,isBoolean:xe,isElement:function(t){return!(!t||t.nodeType!==1)},isString:G,isNumber:He,isDate:Ke,isRegExp:De,isError:Ge,isSymbol:qe,isArrayBuffer:We,isDataView:ae,isArray:te,isFunction:E,isArguments:k,isFinite:function(t){return!qe(t)&&ge(t)&&!isNaN(parseFloat(t))},isNaN:B,isTypedArray:Er,isEmpty:function(t){if(t==null)return!0;var n=le(t);return typeof n=="number"&&(te(t)||G(t)||k(t))?n===0:le(J(t))===0},isMatch:kr,isEqual:function(t,n){return $t(t,n)},isMap:Oa,isWeakMap:Pa,isSet:Na,isWeakSet:_a,keys:J,allKeys:Ye,values:Le,pairs:function(t){for(var n=J(t),a=n.length,i=Array(a),l=0;l<a;l++)i[l]=[n[l],t[n[l]]];return i},invert:_r,functions:Ht,methods:Ht,extend:Br,extendOwn:ft,assign:ft,defaults:Cr,create:function(t,n){var a=Mr(t);return n&&ft(a,n),a},clone:function(t){return ee(t)?te(t)?t.slice():Br({},t):t},tap:function(t,n){return n(t),t},get:Ar,has:function(t,n){for(var a=(n=Je(n)).length,i=0;i<a;i++){var l=n[i];if(!c(t,l))return!1;t=t[l]}return!!a},mapObject:function(t,n,a){n=se(n,a);for(var i=J(t),l=i.length,o={},f=0;f<l;f++){var m=i[f];o[m]=n(t[m],m,t)}return o},identity:Wt,constant:W,noop:jr,toPath:$r,property:Lt,propertyOf:function(t){return t==null?jr:function(n){return Ar(t,n)}},matcher:Qe,matches:Qe,times:function(t,n,a){var i=Array(Math.max(0,t));n=et(n,a,1);for(var l=0;l<t;l++)i[l]=n(l);return i},random:Ut,now:tt,escape:Ba,unescape:Ca,templateSettings:Ma,template:function(t,n,a){!n&&a&&(n=a),n=Cr({},n,F.templateSettings);var i=RegExp([(n.escape||Vt).source,(n.interpolate||Vt).source,(n.evaluate||Vt).source].join("|")+"|$","g"),l=0,o="__p+='";t.replace(i,function(N,D,ie,Me,$e){return o+=t.slice(l,$e).replace(Aa,Fa),l=$e+N.length,D?o+=`'+
((__t=(`+D+`))==null?'':_.escape(__t))+
'`:ie?o+=`'+
((__t=(`+ie+`))==null?'':__t)+
'`:Me&&(o+=`';
`+Me+`
__p+='`),N}),o+=`';
`;var f,m=n.variable;if(m){if(!ja.test(m))throw new Error("variable is not a bare identifier: "+m)}else o=`with(obj||{}){
`+o+`}
`,m="obj";o=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+o+`return __p;
`;try{f=new Function(m,"_",o)}catch(N){throw N.source=o,N}var R=function(N){return f.call(this,N,F)};return R.source="function("+m+`){
`+o+"}",R},result:function(t,n,a){var i=(n=Je(n)).length;if(!i)return E(a)?a.call(t):a;for(var l=0;l<i;l++){var o=t?.[n[l]];o===void 0&&(o=a,l=i),t=E(o)?o.call(t):o}return t},uniqueId:function(t){var n=++Ha+"";return t?t+n:n},chain:function(t){var n=F(t);return n._chain=!0,n},iteratee:Xt,partial:Xe,bind:Wr,bindAll:Da,memoize:function(t,n){var a=function(i){var l=a.cache,o=""+(n?n.apply(this,arguments):i);return c(l,o)||(l[o]=t.apply(this,arguments)),l[o]};return a.cache={},a},delay:Lr,defer:qa,throttle:function(t,n,a){var i,l,o,f,m=0;a||(a={});var R=function(){m=a.leading===!1?0:tt(),i=null,f=t.apply(l,o),i||(l=o=null)},N=function(){var D=tt();m||a.leading!==!1||(m=D);var ie=n-(D-m);return l=this,o=arguments,ie<=0||ie>n?(i&&(clearTimeout(i),i=null),m=D,f=t.apply(l,o),i||(l=o=null)):i||a.trailing===!1||(i=setTimeout(R,ie)),f};return N.cancel=function(){clearTimeout(i),m=0,i=l=o=null},N},debounce:function(t,n,a){var i,l,o,f,m,R=function(){var D=tt()-l;n>D?i=setTimeout(R,n-D):(i=null,a||(f=t.apply(m,o)),i||(o=m=null))},N=H(function(D){return m=this,o=D,l=tt(),i||(i=setTimeout(R,n),a&&(f=t.apply(m,o))),f});return N.cancel=function(){clearTimeout(i),i=o=m=null},N},wrap:function(t,n){return Xe(n,t)},negate:zt,compose:function(){var t=arguments,n=t.length-1;return function(){for(var a=n,i=t[n].apply(this,arguments);a--;)i=t[a].call(this,i);return i}},after:function(t,n){return function(){if(--t<1)return n.apply(this,arguments)}},before:Xr,once:Wa,findKey:Ur,findIndex:Zt,findLastIndex:zr,sortedIndex:Zr,indexOf:Gr,lastIndexOf:La,find:Kt,detect:Kt,findWhere:function(t,n){return Kt(t,Qe(n))},each:ke,forEach:ke,map:Ce,collect:Ce,reduce:Gt,foldl:Gt,inject:Gt,reduceRight:Jr,foldr:Jr,filter:Ue,select:Ue,reject:function(t,n,a){return Ue(t,zt(se(n)),a)},every:Qr,all:Qr,some:en,any:en,contains:Re,includes:Re,include:Re,invoke:Xa,pluck:Yt,where:function(t,n){return Ue(t,Qe(n))},max:tn,min:function(t,n,a){var i,l,o=1/0,f=1/0;if(n==null||typeof n=="number"&&typeof t[0]!="object"&&t!=null)for(var m=0,R=(t=me(t)?t:Le(t)).length;m<R;m++)(i=t[m])!=null&&i<o&&(o=i);else n=se(n,a),ke(t,function(N,D,ie){((l=n(N,D,ie))<f||l===1/0&&o===1/0)&&(o=N,f=l)});return o},shuffle:function(t){return nn(t,1/0)},sample:nn,sortBy:function(t,n,a){var i=0;return n=se(n,a),Yt(Ce(t,function(l,o,f){return{value:l,index:i++,criteria:n(l,o,f)}}).sort(function(l,o){var f=l.criteria,m=o.criteria;if(f!==m){if(f>m||f===void 0)return 1;if(f<m||m===void 0)return-1}return l.index-o.index}),"value")},groupBy:Va,indexBy:za,countBy:Za,partition:Ka,toArray:rn,size:function(t){return t==null?0:me(t)?t.length:J(t).length},pick:an,omit:Ya,first:Jt,head:Jt,take:Jt,initial:un,last:function(t,n,a){return t==null||t.length<1?n==null||a?void 0:[]:n==null||a?t[t.length-1]:pt(t,Math.max(0,t.length-n))},rest:pt,tail:pt,drop:pt,compact:function(t){return Ue(t,Boolean)},flatten:function(t,n){return Be(t,n,!1)},without:Ja,uniq:Qt,unique:Qt,union:Qa,intersection:function(t){for(var n=[],a=arguments.length,i=0,l=le(t);i<l;i++){var o=t[i];if(!Re(n,o)){var f;for(f=1;f<a&&Re(arguments[f],o);f++);f===a&&n.push(o)}}return n},difference:on,unzip:er,transpose:er,zip:eu,object:function(t,n){for(var a={},i=0,l=le(t);i<l;i++)n?a[t[i]]=n[i]:a[t[i][0]]=t[i][1];return a},range:function(t,n,a){n==null&&(n=t||0,t=0),a||(a=n<t?-1:1);for(var i=Math.max(Math.ceil((n-t)/a),0),l=Array(i),o=0;o<i;o++,t+=a)l[o]=t;return l},chunk:function(t,n){if(n==null||n<1)return[];for(var a=[],i=0,l=t.length;i<l;)a.push(b.call(t,i,i+=n));return a},mixin:ln,default:F});return rr._=rr,rr})})(z);var lr={},Q={},lu=z.exports,ce=ru.exports();Q.defer=su;Q.when=ce.resolve;Q.resolve=ce.resolve;Q.all=ce.all;Q.props=ce.props;Q.reject=ce.reject;Q.promisify=ce.promisify;Q.mapSeries=ce.mapSeries;Q.attempt=ce.attempt;Q.nfcall=function(e){var r=Array.prototype.slice.call(arguments,1),u=ce.promisify(e);return u.apply(null,r)};ce.prototype.fail=ce.prototype.caught;ce.prototype.also=function(e){return this.then(function(r){var u=lu.extend({},r,e(r));return ce.props(u)})};function su(){var e,r,u=new ce.Promise(function(s,p){e=s,r=p});return{resolve:e,reject:r,promise:u}}var A={},fu=z.exports,re=A.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function cu(e,r){return r=r||{},{type:re.document,children:e,notes:r.notes||new Rt({}),comments:r.comments||[]}}function pu(e,r){r=r||{};var u=r.indent||{};return{type:re.paragraph,children:e,styleId:r.styleId||null,styleName:r.styleName||null,numbering:r.numbering||null,alignment:r.alignment||null,indent:{start:u.start||null,end:u.end||null,firstLine:u.firstLine||null,hanging:u.hanging||null}}}function mu(e,r){return r=r||{},{type:re.run,children:e,styleId:r.styleId||null,styleName:r.styleName||null,isBold:r.isBold,isUnderline:r.isUnderline,isItalic:r.isItalic,isStrikethrough:r.isStrikethrough,isAllCaps:r.isAllCaps,isSmallCaps:r.isSmallCaps,verticalAlignment:r.verticalAlignment||An.baseline,font:r.font||null,fontSize:r.fontSize||null}}var An={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function du(e){return{type:re.text,value:e}}function hu(){return{type:re.tab}}function vu(e,r){return{type:re.hyperlink,children:e,href:r.href,anchor:r.anchor,targetFrame:r.targetFrame}}function yu(e){return{type:re.noteReference,noteType:e.noteType,noteId:e.noteId}}function Rt(e){this._notes=fu.indexBy(e,function(r){return Fn(r.noteType,r.noteId)})}Rt.prototype.resolve=function(e){return this.findNoteByKey(Fn(e.noteType,e.noteId))};Rt.prototype.findNoteByKey=function(e){return this._notes[e]||null};function gu(e){return{type:re.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function bu(e){return{type:re.commentReference,commentId:e.commentId}}function wu(e){return{type:re.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function Fn(e,r){return e+"-"+r}function xu(e){return{type:re.image,read:e.readImage,altText:e.altText,contentType:e.contentType}}function Tu(e,r){return r=r||{},{type:re.table,children:e,styleId:r.styleId||null,styleName:r.styleName||null}}function Eu(e,r){return r=r||{},{type:re.tableRow,children:e,isHeader:r.isHeader||!1}}function Su(e,r){return r=r||{},{type:re.tableCell,children:e,colSpan:r.colSpan==null?1:r.colSpan,rowSpan:r.rowSpan==null?1:r.rowSpan}}function sr(e){return{type:re.break,breakType:e}}function ku(e){return{type:re.bookmarkStart,name:e.name}}A.document=A.Document=cu;A.paragraph=A.Paragraph=pu;A.run=A.Run=mu;A.Text=du;A.tab=A.Tab=hu;A.Hyperlink=vu;A.noteReference=A.NoteReference=yu;A.Notes=Rt;A.Note=gu;A.commentReference=bu;A.comment=wu;A.Image=xu;A.Table=Tu;A.TableRow=Eu;A.TableCell=Su;A.lineBreak=sr("line");A.pageBreak=sr("page");A.columnBreak=sr("column");A.BookmarkStart=ku;A.verticalAlignment=An;var he={},nt=z.exports;he.Result=Te;he.success=Ru;he.warning=Iu;he.error=Ou;function Te(e,r){this.value=e,this.messages=r||[]}Te.prototype.map=function(e){return new Te(e(this.value),this.messages)};Te.prototype.flatMap=function(e){var r=e(this.value);return new Te(r.value,fr([this,r]))};Te.prototype.flatMapThen=function(e){var r=this;return e(this.value).then(function(u){return new Te(u.value,fr([r,u]))})};Te.combine=function(e){var r=nt.flatten(nt.pluck(e,"value")),u=fr(e);return new Te(r,u)};function Ru(e){return new Te(e,[])}function Iu(e){return{type:"warning",message:e}}function Ou(e){return{type:"error",message:e.message,error:e}}function fr(e){var r=[];return nt.flatten(nt.pluck(e,"messages"),!0).forEach(function(u){Pu(r,u)||r.push(u)}),r}function Pu(e,r){return nt.find(e,Nu.bind(null,r))!==void 0}function Nu(e,r){return e.type===r.type&&e.message===r.message}var it={},_u=nu.exports;it.openArrayBuffer=Bu;it.splitPath=Mu;it.joinPath=$u;function Bu(e){return _u.loadAsync(e).then(function(r){function u(y){return r.file(y)!==null}function s(y,w){return r.file(y).async("uint8array").then(function(b){var v=Cu(b);return w?v.toString(w):v})}function p(y,w){r.file(y,w)}function h(){return r.generateAsync({type:"nodebuffer"})}return{exists:u,read:s,write:p,toBuffer:h}})}function Cu(e){return Buffer.from&&Buffer.from!==Uint8Array.from?Buffer.from(e):new Buffer(e)}function Mu(e){var r=e.lastIndexOf("/");return r===-1?{dirname:"",basename:e}:{dirname:e.substring(0,r),basename:e.substring(r+1)}}function $u(){var e=Array.prototype.filter.call(arguments,function(u){return u}),r=[];return e.forEach(function(u){/^\//.test(u)?r=[u]:r.push(u)}),r.join("/")}var cr={},je={},ot={},It=z.exports;ot.Element=ze;ot.element=function(e,r,u){return new ze(e,r,u)};ot.text=function(e){return{type:"text",value:e}};var jn={first:function(){return null},firstOrEmpty:function(){return jn},attributes:{}};function ze(e,r,u){this.type="element",this.name=e,this.attributes=r||{},this.children=u||[]}ze.prototype.first=function(e){return It.find(this.children,function(r){return r.name===e})};ze.prototype.firstOrEmpty=function(e){return this.first(e)||jn};ze.prototype.getElementsByTagName=function(e){var r=It.filter(this.children,function(u){return u.name===e});return Hn(r)};ze.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var Au={getElementsByTagName:function(e){return Hn(It.flatten(this.map(function(r){return r.getElementsByTagName(e)},!0)))}};function Hn(e){return It.extend(e,Au)}var Dn={},Fu=Q,ju=au,Hu=z.exports,qn=ot,Du=qn.Element;Dn.readString=qu;function qu(e,r){r=r||{};var u=!1,s=ju.parser(!0,{xmlns:!0,position:!1}),p={children:[]},h=p,y=[],w=Fu.defer();s.onopentag=function(v){var T=Wu(v.attributes,function(X){return X.value},b),I=new Du(b(v),T);h.children.push(I),y.push(h),h=I};function b(v){if(v.uri){var T=r[v.uri],I;return T?I=T+":":I="{"+v.uri+"}",I+v.local}else return v.local}return s.onclosetag=function(v){h=y.pop()},s.ontext=function(v){h!==p&&h.children.push(qn.text(v))},s.onend=function(){u||(u=!0,w.resolve(p.children[0]))},s.onerror=function(v){u||(u=!0,w.reject(v))},s.write(e).close(),w.promise}function Wu(e,r,u){return Hu.reduce(e,function(s,p,h){var y=u(p,h,e);return s[y]=r(p,h,e),s},{})}var Wn={},fn=z.exports,Lu=uu;Wn.writeString=Xu;function Xu(e,r){var u=fn.invert(r),s={element:h,text:Uu};function p(b,v){return s[v.type](b,v)}function h(b,v){var T=b.element(y(v.name),v.attributes);v.children.forEach(function(I){p(T,I)})}function y(b){var v=/^\{(.*)\}(.*)$/.exec(b);if(v){var T=u[v[1]];return T+(T===""?"":":")+v[2]}else return b}function w(b){var v=Lu.create(y(b.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return fn.forEach(r,function(T,I){var X="xmlns"+(I===""?"":":"+I);v.attribute(X,T)}),b.children.forEach(function(T){p(v,T)}),v.end()}return w(e)}function Uu(e,r){e.text(r.value)}var pr=ot;je.Element=pr.Element;je.element=pr.element;je.text=pr.text;je.readString=Dn.readString;je.writeString=Wn.writeString;var Vu=z.exports,zu=Q,Zu=je;cr.read=Ln;cr.readXmlFromZipFile=Gu;var Ku={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","urn:schemas-microsoft-com:vml":"v","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:office:word":"office-word"};function Ln(e){return Zu.readString(e,Ku).then(function(r){return Xn(r)[0]})}function Gu(e,r){return e.exists(r)?e.read(r,"utf-8").then(Yu).then(Ln):zu.resolve(null)}function Yu(e){return e.replace(/^\uFEFF/g,"")}function Xn(e){return e.type==="element"?e.name==="mc:AlternateContent"?e.first("mc:Fallback").children:(e.children=Vu.flatten(e.children.map(Xn,!0)),[e]):[e]}var mr={},dr={};dr.uriToZipEntryName=Ju;dr.replaceFragment=Qu;function Ju(e,r){return r.charAt(0)==="/"?r.substr(1):e+"/"+r}function Qu(e,r){var u=e.indexOf("#");return u!==-1&&(e=e.substring(0,u)),e+"#"+r}mr.createBodyReader=ei;mr._readNumberingProperties=Vn;var cn=iu,fe=z.exports,V=A,Un=he.Result,Ie=he.warning,pn=dr;function ei(e){return{readXmlElement:function(r){return new mn(e).readXmlElement(r)},readXmlElements:function(r){return new mn(e).readXmlElements(r)}}}function mn(e){var r=[],u=[],s=e.relationships,p=e.contentTypes,h=e.docxFile,y=e.files,w=e.numbering,b=e.styles;function v(c){var g=c.map(T);return yn(g)}function T(c){if(c.type==="element"){var g=He[c.name];if(g)return g(c);if(!Object.prototype.hasOwnProperty.call(ri,c.name)){var k=Ie("An unrecognised element was ignored: "+c.name);return rt([k])}}return dt()}function I(c){return{start:c.attributes["w:start"]||c.attributes["w:left"],end:c.attributes["w:end"]||c.attributes["w:right"],firstLine:c.attributes["w:firstLine"],hanging:c.attributes["w:hanging"]}}function X(c){return j(c).map(function(g){var k=c.firstOrEmpty("w:sz").attributes["w:val"],B=/^[0-9]+$/.test(k)?parseInt(k,10)/2:null;return{type:"runProperties",styleId:g.styleId,styleName:g.name,verticalAlignment:c.firstOrEmpty("w:vertAlign").attributes["w:val"],font:c.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:B,isBold:C(c.first("w:b")),isUnderline:Z(c.first("w:u")),isItalic:C(c.first("w:i")),isStrikethrough:C(c.first("w:strike")),isAllCaps:C(c.first("w:caps")),isSmallCaps:C(c.first("w:smallCaps"))}})}function Z(c){if(c){var g=c.attributes["w:val"];return g!==void 0&&g!=="false"&&g!=="0"&&g!=="none"}else return!1}function C(c){if(c){var g=c.attributes["w:val"];return g!=="false"&&g!=="0"}else return!1}function O(c){return ge(c,"w:pStyle","Paragraph",b.findParagraphStyleById)}function j(c){return ge(c,"w:rStyle","Run",b.findCharacterStyleById)}function K(c){return ge(c,"w:tblStyle","Table",b.findTableStyleById)}function ge(c,g,k,B){var W=[],L=c.first(g),ue=null,Se=null;if(L&&(ue=L.attributes["w:val"],ue)){var st=B(ue);st?Se=st.name:W.push(te(k,ue))}return ht({styleId:ue,name:Se},W)}var we={type:"unknown"};function Ee(c){var g=c.attributes["w:fldCharType"];if(g==="begin")r.push(we),u=[];else if(g==="end")r.pop();else if(g==="separate"){var k=H(u.join("")),B=k===null?we:{type:"hyperlink",options:k};r.pop(),r.push(B)}return dt()}function q(){var c=fe.last(r.filter(function(g){return g.type==="hyperlink"}));return c?c.options:null}function H(c){var g=/\s*HYPERLINK "(.*)"/.exec(c);if(g)return{href:g[1]};var k=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(c);return k?{anchor:k[1]}:null}function ee(c){return u.push(c.text()),dt()}function Pe(c){var g=c.attributes["w:font"],k=c.attributes["w:char"],B=cn.hex(g,k);return B==null&&/^F0..$/.test(k)&&(B=cn.hex(g,k.substring(2))),B==null?rt([Ie("A w:sym element with an unsupported character was ignored: char "+k+" in font "+g)]):ve(new V.Text(B.string))}function xe(c){return function(g){var k=g.attributes["w:id"];return ve(new V.NoteReference({noteType:c,noteId:k}))}}function U(c){return ve(V.commentReference({commentId:c.attributes["w:id"]}))}function G(c){return v(c.children)}var He={"w:p":function(c){return v(c.children).map(function(g){var k=fe.find(g,dn);return new V.Paragraph(g.filter(vn(dn)),k)}).insertExtra()},"w:pPr":function(c){return O(c).map(function(g){return{type:"paragraphProperties",styleId:g.styleId,styleName:g.name,alignment:c.firstOrEmpty("w:jc").attributes["w:val"],numbering:Vn(g.styleId,c.firstOrEmpty("w:numPr"),w),indent:I(c.firstOrEmpty("w:ind"))}})},"w:r":function(c){return v(c.children).map(function(g){var k=fe.find(g,hn);g=g.filter(vn(hn));var B=q();return B!==null&&(g=[new V.Hyperlink(g,B)]),new V.Run(g,k)})},"w:rPr":X,"w:fldChar":Ee,"w:instrText":ee,"w:t":function(c){return ve(new V.Text(c.text()))},"w:tab":function(c){return ve(new V.Tab)},"w:noBreakHyphen":function(){return ve(new V.Text("\u2011"))},"w:softHyphen":function(c){return ve(new V.Text("\xAD"))},"w:sym":Pe,"w:hyperlink":function(c){var g=c.attributes["r:id"],k=c.attributes["w:anchor"];return v(c.children).map(function(B){function W(ue){var Se=c.attributes["w:tgtFrame"]||null;return new V.Hyperlink(B,fe.extend({targetFrame:Se},ue))}if(g){var L=s.findTargetByRelationshipId(g);return k&&(L=pn.replaceFragment(L,k)),W({href:L})}else return k?W({anchor:k}):B})},"w:tbl":Ke,"w:tr":Ge,"w:tc":qe,"w:footnoteReference":xe("footnote"),"w:endnoteReference":xe("endnote"),"w:commentReference":U,"w:br":function(c){var g=c.attributes["w:type"];return g==null||g==="textWrapping"?ve(V.lineBreak):g==="page"?ve(V.pageBreak):g==="column"?ve(V.columnBreak):rt([Ie("Unsupported break type: "+g)])},"w:bookmarkStart":function(c){var g=c.attributes["w:name"];return g==="_GoBack"?dt():ve(new V.BookmarkStart({name:g}))},"mc:AlternateContent":function(c){return G(c.first("mc:Fallback"))},"w:sdt":function(c){return v(c.firstOrEmpty("w:sdtContent").children)},"w:ins":G,"w:object":G,"w:smartTag":G,"w:drawing":G,"w:pict":function(c){return G(c).toExtra()},"v:roundrect":G,"v:shape":G,"v:textbox":G,"w:txbxContent":G,"wp:inline":S,"wp:anchor":S,"v:imagedata":M,"v:group":G,"v:rect":G};return{readXmlElement:T,readXmlElements:v};function Ke(c){var g=De(c.firstOrEmpty("w:tblPr"));return v(c.children).flatMap(d).flatMap(function(k){return g.map(function(B){return V.Table(k,B)})})}function De(c){return K(c).map(function(g){return{styleId:g.styleId,styleName:g.name}})}function Ge(c){var g=c.firstOrEmpty("w:trPr"),k=!!g.first("w:tblHeader");return v(c.children).map(function(B){return V.TableRow(B,{isHeader:k})})}function qe(c){return v(c.children).map(function(g){var k=c.firstOrEmpty("w:tcPr"),B=k.firstOrEmpty("w:gridSpan").attributes["w:val"],W=B?parseInt(B,10):1,L=V.TableCell(g,{colSpan:W});return L._vMerge=We(k),L})}function We(c){var g=c.first("w:vMerge");if(g){var k=g.attributes["w:val"];return k==="continue"||!k}else return null}function d(c){var g=fe.any(c,function(W){return W.type!==V.types.tableRow});if(g)return ht(c,[Ie("unexpected non-row element in table, cell merging may be incorrect")]);var k=fe.any(c,function(W){return fe.any(W.children,function(L){return L.type!==V.types.tableCell})});if(k)return ht(c,[Ie("unexpected non-cell element in table row, cell merging may be incorrect")]);var B={};return c.forEach(function(W){var L=0;W.children.forEach(function(ue){ue._vMerge&&B[L]?B[L].rowSpan++:(B[L]=ue,ue._vMerge=!1),L+=ue.colSpan})}),c.forEach(function(W){W.children=W.children.filter(function(L){return!L._vMerge}),W.children.forEach(function(L){delete L._vMerge})}),ve(c)}function S(c){var g=c.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return yn(g.map(E.bind(null,c)))}function E(c,g){var k=c.first("wp:docPr").attributes,B=P(k.descr)?k.title:k.descr,W=_(g);return W===null?rt([Ie("Could not find image file for a:blip element")]):ae(W,B)}function P(c){return c==null||/^\s*$/.test(c)}function _(c){var g=c.attributes["r:embed"],k=c.attributes["r:link"];if(g)return Y(g);if(k){var B=s.findTargetByRelationshipId(k);return{path:B,read:y.read.bind(y,B)}}else return null}function M(c){var g=c.attributes["r:id"];return g?ae(Y(g),c.attributes["o:title"]):rt([Ie("A v:imagedata element without a relationship ID was ignored")])}function Y(c){var g=pn.uriToZipEntryName("word",s.findTargetByRelationshipId(c));return{path:g,read:h.read.bind(h,g)}}function ae(c,g){var k=p.findContentType(c.path),B=V.Image({readImage:c.read,altText:g,contentType:k}),W=ti[k]?[]:Ie("Image of type "+k+" is unlikely to display in web browsers");return ht(B,W)}function te(c,g){return Ie(c+" style with ID "+g+" was referenced but not defined in the document")}}function Vn(e,r,u){if(e!=null){var s=u.findLevelByParagraphStyleId(e);if(s!=null)return s}var p=r.firstOrEmpty("w:ilvl").attributes["w:val"],h=r.firstOrEmpty("w:numId").attributes["w:val"];return p===void 0||h===void 0?null:u.findLevel(h,p)}var ti={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},ri={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function dn(e){return e.type==="paragraphProperties"}function hn(e){return e.type==="runProperties"}function vn(e){return function(r){return!e(r)}}function rt(e){return new de(null,null,e)}function dt(){return new de(null)}function ve(e){return new de(e)}function ht(e,r){return new de(e,null,r)}function de(e,r,u){this.value=e||[],this.extra=r,this._result=new Un({element:this.value,extra:r},u),this.messages=this._result.messages}de.prototype.toExtra=function(){return new de(null,hr(this.extra,this.value),this.messages)};de.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new de(hr(this.value,e),null,this.messages):this};de.prototype.map=function(e){var r=this._result.map(function(u){return e(u.element)});return new de(r.value,this.extra,r.messages)};de.prototype.flatMap=function(e){var r=this._result.flatMap(function(u){return e(u.element)._result});return new de(r.value.element,hr(this.extra,r.value.extra),r.messages)};function yn(e){var r=Un.combine(fe.pluck(e,"_result"));return new de(fe.flatten(fe.pluck(r.value,"element")),fe.filter(fe.flatten(fe.pluck(r.value,"extra")),ni),r.messages)}function hr(e,r){return fe.flatten([e,r])}function ni(e){return e}var zn={};zn.DocumentXmlReader=ii;var ai=A,ui=he.Result;function ii(e){var r=e.bodyReader;function u(s){var p=s.first("w:body"),h=r.readXmlElements(p.children).map(function(y){return new ai.Document(y,{notes:e.notes,comments:e.comments})});return new ui(h.value,h.messages)}return{convertXmlToDocument:u}}var Ot={};Ot.readRelationships=oi;Ot.defaultValue=new vr([]);Ot.Relationships=vr;function oi(e){var r=[];return e.children.forEach(function(u){if(u.name==="{http://schemas.openxmlformats.org/package/2006/relationships}Relationship"){var s={relationshipId:u.attributes.Id,target:u.attributes.Target,type:u.attributes.Type};r.push(s)}}),new vr(r)}function vr(e){var r={};e.forEach(function(s){r[s.relationshipId]=s.target});var u={};return e.forEach(function(s){u[s.type]||(u[s.type]=[]),u[s.type].push(s.target)}),{findTargetByRelationshipId:function(s){return r[s]},findTargetsByType:function(s){return u[s]||[]}}}var yr={};yr.readContentTypesFromXml=si;var li={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};yr.defaultContentTypes=Zn({},{});function si(e){var r={},u={};return e.children.forEach(function(s){if(s.name==="content-types:Default"&&(r[s.attributes.Extension]=s.attributes.ContentType),s.name==="content-types:Override"){var p=s.attributes.PartName;p.charAt(0)==="/"&&(p=p.substring(1)),u[p]=s.attributes.ContentType}}),Zn(u,r)}function Zn(e,r){return{findContentType:function(u){var s=e[u];if(s)return s;var p=u.split("."),h=p[p.length-1];if(r.hasOwnProperty(h))return r[h];var y=li[h.toLowerCase()];return y?"image/"+y:null}}}var Pt={},vt=z.exports;Pt.readNumberingXml=fi;Pt.Numbering=gr;Pt.defaultNumbering=new gr({},{});function gr(e,r,u){var s=vt.flatten(vt.values(r).map(function(w){return vt.values(w.levels)})),p=vt.indexBy(s.filter(function(w){return w.paragraphStyleId!=null}),"paragraphStyleId");function h(w,b){var v=e[w];if(v){var T=r[v.abstractNumId];if(T){if(T.numStyleLink==null)return r[v.abstractNumId].levels[b];var I=u.findNumberingStyleById(T.numStyleLink);return h(I.numId,b)}else return null}else return null}function y(w){return p[w]||null}return{findLevel:h,findLevelByParagraphStyleId:y}}function fi(e,r){if(!r||!r.styles)throw new Error("styles is missing");var u=ci(e),s=mi(e);return new gr(s,u,r.styles)}function ci(e){var r={};return e.getElementsByTagName("w:abstractNum").forEach(function(u){var s=u.attributes["w:abstractNumId"];r[s]=pi(u)}),r}function pi(e){var r={};e.getElementsByTagName("w:lvl").forEach(function(s){var p=s.attributes["w:ilvl"],h=s.first("w:numFmt").attributes["w:val"],y=s.firstOrEmpty("w:pStyle").attributes["w:val"];r[p]={isOrdered:h!=="bullet",level:p,paragraphStyleId:y}});var u=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:r,numStyleLink:u}}function mi(e){var r={};return e.getElementsByTagName("w:num").forEach(function(u){var s=u.attributes["w:numId"],p=u.first("w:abstractNumId").attributes["w:val"];r[s]={abstractNumId:p}}),r}var Nt={};Nt.readStylesXml=di;Nt.Styles=at;Nt.defaultStyles=new at({},{});function at(e,r,u,s){return{findParagraphStyleById:function(p){return e[p]},findCharacterStyleById:function(p){return r[p]},findTableStyleById:function(p){return u[p]},findNumberingStyleById:function(p){return s[p]}}}at.EMPTY=new at({},{},{},{});function di(e){var r={},u={},s={},p={},h={paragraph:r,character:u,table:s};return e.getElementsByTagName("w:style").forEach(function(y){var w=hi(y);if(w.type==="numbering")p[w.styleId]=yi(y);else{var b=h[w.type];b&&(b[w.styleId]=w)}}),new at(r,u,s,p)}function hi(e){var r=e.attributes["w:type"],u=e.attributes["w:styleId"],s=vi(e);return{type:r,styleId:u,name:s}}function vi(e){var r=e.first("w:name");return r?r.attributes["w:val"]:null}function yi(e){var r=e.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{numId:r}}var br={},gi=A,bi=he.Result;br.createFootnotesReader=Kn.bind(Fe,"footnote");br.createEndnotesReader=Kn.bind(Fe,"endnote");function Kn(e,r){function u(h){return bi.combine(h.getElementsByTagName("w:"+e).filter(s).map(p))}function s(h){var y=h.attributes["w:type"];return y!=="continuationSeparator"&&y!=="separator"}function p(h){var y=h.attributes["w:id"];return r.readXmlElements(h.children).map(function(w){return gi.Note({noteType:e,noteId:y,body:w})})}return u}var Gn={},wi=A,xi=he.Result;function Ti(e){function r(s){return xi.combine(s.getElementsByTagName("w:comment").map(u))}function u(s){var p=s.attributes["w:id"];function h(y){return(s.attributes[y]||"").trim()||null}return e.readXmlElements(s.children).map(function(y){return wi.comment({commentId:p,body:y,authorName:h("w:author"),authorInitials:h("w:initials")})})}return r}Gn.createCommentsReader=Ti;var Yn={},Ei=Q;Yn.Files=Si;function Si(){function e(r){return Ei.reject(new Error("could not open external image: '"+r+`'
cannot open linked files from a web browser`))}return{read:e}}lr.read=Bi;lr._findPartPaths=Qn;var ki=tu,Ri=Q,Ii=A,nr=he.Result,Et=it,Jn=cr.readXmlFromZipFile,Oi=mr.createBodyReader,Pi=zn.DocumentXmlReader,Ve=Ot,gn=yr,bn=Pt,wn=Nt,xn=br,Ni=Gn,_i=Yn.Files;function Bi(e,r){return r=r||{},Ri.props({contentTypes:Mi(e),partPaths:Qn(e),docxFile:e,files:new _i(r.path?ki.dirname(r.path):null)}).also(function(u){return{styles:Ai(e,u.partPaths.styles)}}).also(function(u){return{numbering:$i(e,u.partPaths.numbering,u.styles)}}).also(function(u){return{footnotes:yt(u.partPaths.footnotes,u,function(s,p){return p?xn.createFootnotesReader(s)(p):new nr([])}),endnotes:yt(u.partPaths.endnotes,u,function(s,p){return p?xn.createEndnotesReader(s)(p):new nr([])}),comments:yt(u.partPaths.comments,u,function(s,p){return p?Ni.createCommentsReader(s)(p):new nr([])})}}).also(function(u){return{notes:u.footnotes.flatMap(function(s){return u.endnotes.map(function(p){return new Ii.Notes(s.concat(p))})})}}).then(function(u){return yt(u.partPaths.mainDocument,u,function(s,p){return u.notes.flatMap(function(h){return u.comments.flatMap(function(y){var w=new Pi({bodyReader:s,notes:h,comments:y});return w.convertXmlToDocument(p)})})})})}function Qn(e){return Fi(e).then(function(r){var u=Tn({docxFile:e,relationships:r,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(u))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return Ze({filename:ea(u),readElement:Ve.readRelationships,defaultValue:Ve.defaultValue})(e).then(function(s){function p(h){return Tn({docxFile:e,relationships:s,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+h,basePath:Et.splitPath(u).dirname,fallbackPath:"word/"+h+".xml"})}return{mainDocument:u,comments:p("comments"),endnotes:p("endnotes"),footnotes:p("footnotes"),numbering:p("numbering"),styles:p("styles")}})})}function Tn(e){var r=e.docxFile,u=e.relationships,s=e.relationshipType,p=e.basePath,h=e.fallbackPath,y=u.findTargetsByType(s),w=y.map(function(v){return Ci(Et.joinPath(p,v),"/")}),b=w.filter(function(v){return r.exists(v)});return b.length===0?h:b[0]}function Ci(e,r){return e.substring(0,r.length)===r?e.substring(r.length):e}function Ze(e){return function(r){return Jn(r,e.filename).then(function(u){return u?e.readElement(u):e.defaultValue})}}function yt(e,r,u){var s=Ze({filename:ea(e),readElement:Ve.readRelationships,defaultValue:Ve.defaultValue});return s(r.docxFile).then(function(p){var h=new Oi({relationships:p,contentTypes:r.contentTypes,docxFile:r.docxFile,numbering:r.numbering,styles:r.styles,files:r.files});return Jn(r.docxFile,e).then(function(y){return u(h,y)})})}function ea(e){var r=Et.splitPath(e);return Et.joinPath(r.dirname,"_rels",r.basename+".rels")}var Mi=Ze({filename:"[Content_Types].xml",readElement:gn.readContentTypesFromXml,defaultValue:gn.defaultContentTypes});function $i(e,r,u){return Ze({filename:r,readElement:function(s){return bn.readNumberingXml(s,{styles:u})},defaultValue:bn.defaultNumbering})(e)}function Ai(e,r){return Ze({filename:r,readElement:wn.readStylesXml,defaultValue:wn.defaultStyles})(e)}var Fi=Ze({filename:"_rels/.rels",readElement:Ve.readRelationships,defaultValue:Ve.defaultValue}),wr={},ji=z.exports,Hi=Q,ut=je;wr.writeStyleMap=qi;wr.readStyleMap=Xi;var Di="http://schemas.zwobble.org/mammoth/style-map",St="mammoth/style-map",ta="/"+St;function qi(e,r){return e.write(St,r),Wi(e).then(function(){return Li(e)})}function Wi(e){var r="word/_rels/document.xml.rels",u="http://schemas.openxmlformats.org/package/2006/relationships",s="{"+u+"}Relationship";return e.read(r,"utf8").then(ut.readString).then(function(p){var h=p.children;ra(h,s,"Id",{Id:"rMammothStyleMap",Type:Di,Target:ta});var y={"":u};return e.write(r,ut.writeString(p,y))})}function Li(e){var r="[Content_Types].xml",u="http://schemas.openxmlformats.org/package/2006/content-types",s="{"+u+"}Override";return e.read(r,"utf8").then(ut.readString).then(function(p){var h=p.children;ra(h,s,"PartName",{PartName:ta,ContentType:"text/prs.mammoth.style-map"});var y={"":u};return e.write(r,ut.writeString(p,y))})}function ra(e,r,u,s){var p=ji.find(e,function(h){return h.name===r&&h.attributes[u]===s[u]});p?p.attributes=s:e.push(ut.element(r,s))}function Xi(e){return e.exists(St)?e.read(St,"utf8"):Hi.resolve(null)}var xr={},Ae={},Oe={},Ne={},En;function na(){if(En)return Ne;En=1;var e=Bt();function r(b,v,T){return s(e.element(b,v,{fresh:!1}),T)}function u(b,v,T){var I=e.element(b,v,{fresh:!0});return s(I,T)}function s(b,v){return{type:"element",tag:b,children:v||[]}}function p(b){return{type:"text",value:b}}var h={type:"forceWrite"};Ne.freshElement=u,Ne.nonFreshElement=r,Ne.elementWithTag=s,Ne.text=p,Ne.forceWrite=h;var y={br:!0,hr:!0,img:!0};function w(b){return b.children.length===0&&y[b.tag.tagName]}return Ne.isVoidElement=w,Ne}var ar,Sn;function Ui(){if(Sn)return ar;Sn=1;var e=z.exports,r=na();function u(O){return s(v(O))}function s(O){var j=[];return O.map(p).forEach(function(K){b(j,K)}),j}function p(O){return h[O.type](O)}var h={element:y,text:w,forceWrite:w};function y(O){return r.elementWithTag(O.tag,s(O.children))}function w(O){return O}function b(O,j){var K=O[O.length-1];j.type==="element"&&!j.tag.fresh&&K&&K.type==="element"&&j.tag.matchesElement(K.tag)?(j.tag.separator&&b(K.children,r.text(j.tag.separator)),j.children.forEach(function(ge){b(K.children,ge)})):O.push(j)}function v(O){return T(O,function(j){return I[j.type](j)})}function T(O,j){return e.flatten(e.map(O,j),!0)}var I={element:Z,text:C,forceWrite:X};function X(O){return[O]}function Z(O){var j=v(O.children);return j.length===0&&!r.isVoidElement(O)?[]:[r.elementWithTag(O.tag,j)]}function C(O){return O.value.length===0?[]:[O]}return ar=u,ar}var kn;function _t(){if(kn)return Oe;kn=1;var e=na();Oe.freshElement=e.freshElement,Oe.nonFreshElement=e.nonFreshElement,Oe.elementWithTag=e.elementWithTag,Oe.text=e.text,Oe.forceWrite=e.forceWrite,Oe.simplify=Ui();function r(y,w){w.forEach(function(b){u(y,b)})}function u(y,w){s[w.type](y,w)}var s={element:p,text:h,forceWrite:function(){}};function p(y,w){e.isVoidElement(w)?y.selfClosing(w.tag.tagName,w.tag.attributes):(y.open(w.tag.tagName,w.tag.attributes),r(y,w.children),y.close(w.tag.tagName))}function h(y,w){y.text(w.value)}return Oe.write=r,Oe}var Rn;function Bt(){if(Rn)return Ae;Rn=1;var e=z.exports,r=_t();Ae.topLevelElement=u,Ae.elements=s,Ae.element=h;function u(w,b){return s([h(w,b,{fresh:!0})])}function s(w){return new p(w.map(function(b){return e.isString(b)?h(b):b}))}function p(w){this._elements=w}p.prototype.wrap=function(b){for(var v=b(),T=this._elements.length-1;T>=0;T--)v=this._elements[T].wrapNodes(v);return v};function h(w,b,v){return v=v||{},new y(w,b,v)}function y(w,b,v){var T={};e.isArray(w)?(w.forEach(function(I){T[I]=!0}),w=w[0]):T[w]=!0,this.tagName=w,this.tagNames=T,this.attributes=b||{},this.fresh=v.fresh,this.separator=v.separator}return y.prototype.matchesElement=function(w){return this.tagNames[w.tagName]&&e.isEqual(this.attributes||{},w.attributes||{})},y.prototype.wrap=function(b){return this.wrapNodes(b())},y.prototype.wrapNodes=function(b){return[r.elementWithTag(this,b)]},Ae.empty=s([]),Ae.ignore={wrap:function(){return[]}},Ae}var aa={};(function(e){var r=z.exports,u=Q,s=_t();e.imgElement=p;function p(h){return function(y,w){return u.when(h(y)).then(function(b){var v={};return y.altText&&(v.alt=y.altText),r.extend(v,b),[s.freshElement("img",v)]})}}e.inline=e.imgElement,e.dataUri=p(function(h){return h.read("base64").then(function(y){return{src:"data:"+h.contentType+";base64,"+y}})})})(aa);var ua={},ia={},gt=ou,oa=z.exports;ia.writer=Vi;function Vi(e){return e=e||{},e.prettyPrint?zi():la()}var bt={div:!0,p:!0,ul:!0,li:!0};function zi(){var e=0,r="  ",u=[],s=!0,p=!1,h=la();function y(C,O){bt[C]&&X(),u.push(C),h.open(C,O),bt[C]&&e++,s=!1}function w(C){bt[C]&&(e--,X()),u.pop(),h.close(C)}function b(C){I();var O=Z()?C:C.replace(`
`,`
`+r);h.text(O)}function v(C,O){X(),h.selfClosing(C,O)}function T(){return u.length===0||bt[u[u.length-1]]}function I(){p||(X(),p=!0)}function X(){if(p=!1,!s&&T()&&!Z()){h._append(`
`);for(var C=0;C<e;C++)h._append(r)}}function Z(){return oa.some(u,function(C){return C==="pre"})}return{asString:h.asString,open:y,close:w,text:b,selfClosing:v}}function la(){var e=[];function r(b,v){var T=p(v);e.push(gt.format("<%s%s>",b,T))}function u(b){e.push(gt.format("</%s>",b))}function s(b,v){var T=p(v);e.push(gt.format("<%s%s />",b,T))}function p(b){return oa.map(b,function(v,T){return gt.format(' %s="%s"',T,Ki(v))}).join("")}function h(b){e.push(Zi(b))}function y(b){e.push(b)}function w(){return e.join("")}return{asString:w,open:r,close:u,text:h,selfClosing:s,_append:y}}function Zi(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ki(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var sa={},Gi=z.exports;function In(e){return kt(e,e)}function kt(e,r){return function(){return{start:e,end:r}}}function Yi(e){var r=e.href||"";return r?{start:"[",end:"]("+r+")",anchorPosition:"before"}:{}}function Ji(e){var r=e.src||"",u=e.alt||"";return r||u?{start:"!["+u+"]("+r+")"}:{}}function On(e){return function(r,u){return{start:u?`
`:"",end:u?"":`
`,list:{isOrdered:e.isOrdered,indent:u?u.indent+1:0,count:0}}}}function Qi(e,r,u){r=r||{indent:0,isOrdered:!1,count:0},r.count++,u.hasClosed=!1;var s=r.isOrdered?r.count+".":"-",p=ca("	",r.indent)+s+" ";return{start:p,end:function(){if(!u.hasClosed)return u.hasClosed=!0,`
`}}}var fa={p:kt("",`

`),br:kt("",`  
`),ul:On({isOrdered:!1}),ol:On({isOrdered:!0}),li:Qi,strong:In("__"),em:In("*"),a:Yi,img:Ji};(function(){for(var e=1;e<=6;e++)fa["h"+e]=kt(ca("#",e)+" ",`

`)})();function ca(e,r){return new Array(r+1).join(e)}function eo(){var e=[],r=[],u=null,s={};function p(T,I){I=I||{};var X=fa[T]||function(){return{}},Z=X(I,u,s);r.push({end:Z.end,list:u}),Z.list&&(u=Z.list);var C=Z.anchorPosition==="before";C&&h(I),e.push(Z.start||""),C||h(I)}function h(T){T.id&&e.push('<a id="'+T.id+'"></a>')}function y(T){var I=r.pop();u=I.list;var X=Gi.isFunction(I.end)?I.end():I.end;e.push(X||"")}function w(T,I){p(T,I),y()}function b(T){e.push(to(T))}function v(){return e.join("")}return{asString:v,open:p,close:y,text:b,selfClosing:w}}sa.writer=eo;function to(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}var ro=ia,no=sa;ua.writer=ao;function ao(e){return e=e||{},e.outputFormat==="markdown"?no.writer():ro.writer(e)}var _e=z.exports,Pn=Q,wt=A,ye=Bt(),or=he,uo=aa,$=_t(),io=ua;xr.DocumentConverter=oo;function oo(e){return{convertToHtml:function(r){var u=_e.indexBy(r.type===wt.types.document?r.comments:[],"commentId"),s=new lo(e,u);return s.convertToHtml(r)}}}function lo(e,r){var u=1,s=[],p=[];e=_e.extend({ignoreEmptyParagraphs:!0},e);var h=e.idPrefix===void 0?"":e.idPrefix,y=e.ignoreEmptyParagraphs,w=ye.topLevelElement("p"),b=e.styleMap||[];function v(d){var S=[],E=I(d,S,{}),P=[];pa(E,function(M){M.type==="deferred"&&P.push(M)});var _={};return Pn.mapSeries(P,function(M){return M.value().then(function(Y){_[M.id]=Y})}).then(function(){function M(ae){return ur(ae,function(te){return te.type==="deferred"?_[te.id]:te.children?[_e.extend({},te,{children:M(te.children)})]:[te]})}var Y=io.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return $.write(Y,$.simplify(M(E))),new or.Result(Y.asString(),S)})}function T(d,S,E){return ur(d,function(P){return I(P,S,E)})}function I(d,S,E){if(!E)throw new Error("options not set");var P=We[d.type];return P?P(d,S,E):[]}function X(d,S,E){return Z(d,S).wrap(function(){var P=T(d.children,S,E);return y?P:[$.forceWrite].concat(P)})}function Z(d,S){var E=K(d);return E?E.to:(d.styleId&&S.push(Nn("paragraph",d)),w)}function C(d,S,E){var P=function(){return T(d.children,S,E)},_=[];d.isSmallCaps&&_.push(O("smallCaps")),d.isAllCaps&&_.push(O("allCaps")),d.isStrikethrough&&_.push(O("strikethrough","s")),d.isUnderline&&_.push(O("underline")),d.verticalAlignment===wt.verticalAlignment.subscript&&_.push(ye.element("sub",{},{fresh:!1})),d.verticalAlignment===wt.verticalAlignment.superscript&&_.push(ye.element("sup",{},{fresh:!1})),d.isItalic&&_.push(O("italic","em")),d.isBold&&_.push(O("bold","strong"));var M=ye.empty,Y=K(d);return Y?M=Y.to:d.styleId&&S.push(Nn("run",d)),_.push(M),_.forEach(function(ae){P=ae.wrap.bind(ae,P)}),P()}function O(d,S){var E=j({type:d});return E||(S?ye.element(S,{},{fresh:!1}):ye.empty)}function j(d,S){var E=K(d);return E?E.to:S}function K(d){for(var S=0;S<b.length;S++)if(b[S].from.matches(d))return b[S]}function ge(d){return function(S,E){return Pn.attempt(function(){return d(S,E)}).caught(function(P){return E.push(or.error(P)),[]})}}function we(d){return q(d.noteType,d.noteId)}function Ee(d){return H(d.noteType,d.noteId)}function q(d,S){return ee(d+"-"+S)}function H(d,S){return ee(d+"-ref-"+S)}function ee(d){return h+d}var Pe=ye.elements([ye.element("table",{},{fresh:!0})]);function xe(d,S,E){return j(d,Pe).wrap(function(){return U(d,S,E)})}function U(d,S,E){var P=_e.findIndex(d.children,function(ae){return!ae.type===wt.types.tableRow||!ae.isHeader});P===-1&&(P=d.children.length);var _;if(P===0)_=T(d.children,S,_e.extend({},E,{isTableHeader:!1}));else{var M=T(d.children.slice(0,P),S,_e.extend({},E,{isTableHeader:!0})),Y=T(d.children.slice(P),S,_e.extend({},E,{isTableHeader:!1}));_=[$.freshElement("thead",{},M),$.freshElement("tbody",{},Y)]}return[$.forceWrite].concat(_)}function G(d,S,E){var P=T(d.children,S,E);return[$.freshElement("tr",{},[$.forceWrite].concat(P))]}function He(d,S,E){var P=E.isTableHeader?"th":"td",_=T(d.children,S,E),M={};return d.colSpan!==1&&(M.colspan=d.colSpan.toString()),d.rowSpan!==1&&(M.rowspan=d.rowSpan.toString()),[$.freshElement(P,M,[$.forceWrite].concat(_))]}function Ke(d,S,E){return j(d,ye.ignore).wrap(function(){var P=r[d.commentId],_=p.length+1,M="["+co(P)+_+"]";return p.push({label:M,comment:P}),[$.freshElement("a",{href:"#"+q("comment",d.commentId),id:H("comment",d.commentId)},[$.text(M)])]})}function De(d,S,E){var P=d.label,_=d.comment,M=T(_.body,S,E).concat([$.nonFreshElement("p",{},[$.text(" "),$.freshElement("a",{href:"#"+H("comment",_.commentId)},[$.text("\u2191")])])]);return[$.freshElement("dt",{id:q("comment",_.commentId)},[$.text("Comment "+P)]),$.freshElement("dd",{},M)]}function Ge(d,S,E){return qe(d).wrap(function(){return[]})}function qe(d){var S=K(d);return S?S.to:d.breakType==="line"?ye.topLevelElement("br"):ye.empty}var We={document:function(d,S,E){var P=T(d.children,S,E),_=s.map(function(Y){return d.notes.resolve(Y)}),M=T(_,S,E);return P.concat([$.freshElement("ol",{},M),$.freshElement("dl",{},ur(p,function(Y){return De(Y,S,E)}))])},paragraph:X,run:C,text:function(d,S,E){return[$.text(d.value)]},tab:function(d,S,E){return[$.text("	")]},hyperlink:function(d,S,E){var P=d.anchor?"#"+ee(d.anchor):d.href,_={href:P};d.targetFrame!=null&&(_.target=d.targetFrame);var M=T(d.children,S,E);return[$.nonFreshElement("a",_,M)]},bookmarkStart:function(d,S,E){var P=$.freshElement("a",{id:ee(d.name)},[$.forceWrite]);return[P]},noteReference:function(d,S,E){s.push(d);var P=$.freshElement("a",{href:"#"+we(d),id:Ee(d)},[$.text("["+u+++"]")]);return[$.freshElement("sup",{},[P])]},note:function(d,S,E){var P=T(d.body,S,E),_=$.elementWithTag(ye.element("p",{},{fresh:!1}),[$.text(" "),$.freshElement("a",{href:"#"+Ee(d)},[$.text("\u2191")])]),M=P.concat([_]);return $.freshElement("li",{id:we(d)},M)},commentReference:Ke,comment:De,image:fo(ge(e.convertImage||uo.dataUri)),table:xe,tableRow:G,tableCell:He,break:Ge};return{convertToHtml:v}}var so=1;function fo(e){return function(r,u,s){return[{type:"deferred",id:so++,value:function(){return e(r,u,s)}}]}}function Nn(e,r){return or.warning("Unrecognised "+e+" style: '"+r.styleName+"' (Style ID: "+r.styleId+")")}function ur(e,r){return _e.flatten(e.map(r),!0)}function pa(e,r){e.forEach(function(u){r(u),u.children&&pa(u.children,r)})}var co=xr.commentAuthorLabel=function(r){return r.authorInitials||""},Ct={},ne={};ne.paragraph=po;ne.run=mo;ne.table=ho;ne.bold=new pe("bold");ne.italic=new pe("italic");ne.underline=new pe("underline");ne.strikethrough=new pe("strikethrough");ne.allCaps=new pe("allCaps");ne.smallCaps=new pe("smallCaps");ne.commentReference=new pe("commentReference");ne.lineBreak=new pe("break",{breakType:"line"});ne.pageBreak=new pe("break",{breakType:"page"});ne.columnBreak=new pe("break",{breakType:"column"});ne.equalTo=yo;ne.startsWith=go;function po(e){return new pe("paragraph",e)}function mo(e){return new pe("run",e)}function ho(e){return new pe("table",e)}function pe(e,r){r=r||{},this._elementType=e,this._styleId=r.styleId,this._styleName=r.styleName,r.list&&(this._listIndex=r.list.levelIndex,this._listIsOrdered=r.list.isOrdered)}pe.prototype.matches=function(e){return e.type===this._elementType&&(this._styleId===void 0||e.styleId===this._styleId)&&(this._styleName===void 0||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(this._listIndex===void 0||vo(e,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===e.breakType)};function vo(e,r,u){return e.numbering&&e.numbering.level==r&&e.numbering.isOrdered==u}function yo(e){return{operator:bo,operand:e}}function go(e){return{operator:wo,operand:e}}function bo(e,r){return e.toUpperCase()===r.toUpperCase()}function wo(e,r){return r.toUpperCase().indexOf(e.toUpperCase())===0}var ma={},xo=$n,To=xo.RegexTokeniser;ma.tokenise=Eo;var _n="'((?:\\\\.|[^'])*)";function Eo(e){var r="(?:[a-zA-Z\\-_]|\\\\.)",u=new To([{name:"identifier",regex:new RegExp("("+r+"(?:"+r+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(_n+"'")},{name:"unterminated-string",regex:new RegExp(_n)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return u.tokenise(e)}var So=z.exports,x=$n,oe=ne,xt=Bt(),ko=ma.tokenise,ir=he;Ct.readHtmlPath=Po;Ct.readDocumentMatcher=Oo;Ct.readStyle=Ro;function Ro(e){return Tr(Mo,e)}function Io(){return x.rules.sequence(x.rules.sequence.capture(da()),x.rules.tokenOfType("whitespace"),x.rules.tokenOfType("arrow"),x.rules.sequence.capture(x.rules.optional(x.rules.sequence(x.rules.tokenOfType("whitespace"),x.rules.sequence.capture(ha())).head())),x.rules.tokenOfType("end")).map(function(e,r){return{from:e,to:r.valueOrElse(xt.empty)}})}function Oo(e){return Tr(da(),e)}function da(){var e=x.rules.sequence,r=function(q,H){return x.rules.then(x.rules.token("identifier",q),function(){return H})},u=r("p",oe.paragraph),s=r("r",oe.run),p=x.rules.firstOf("p or r or table",u,s),h=x.rules.then(ga,function(q){return{styleId:q}}),y=x.rules.firstOf("style name matcher",x.rules.then(x.rules.sequence(x.rules.tokenOfType("equals"),x.rules.sequence.cut(),x.rules.sequence.capture(Tt)).head(),function(q){return{styleName:oe.equalTo(q)}}),x.rules.then(x.rules.sequence(x.rules.tokenOfType("startsWith"),x.rules.sequence.cut(),x.rules.sequence.capture(Tt)).head(),function(q){return{styleName:oe.startsWith(q)}})),w=x.rules.sequence(x.rules.tokenOfType("open-square-bracket"),x.rules.sequence.cut(),x.rules.token("identifier","style-name"),x.rules.sequence.capture(y),x.rules.tokenOfType("close-square-bracket")).head(),b=x.rules.firstOf("list type",r("ordered-list",{isOrdered:!0}),r("unordered-list",{isOrdered:!1})),v=e(x.rules.tokenOfType("colon"),e.capture(b),e.cut(),x.rules.tokenOfType("open-paren"),e.capture(No),x.rules.tokenOfType("close-paren")).map(function(q,H){return{list:{isOrdered:q.isOrdered,levelIndex:H-1}}});function T(q){var H=x.rules.firstOf.apply(x.rules.firstOf,["matcher suffix"].concat(q)),ee=x.rules.zeroOrMore(H);return x.rules.then(ee,function(Pe){var xe={};return Pe.forEach(function(U){So.extend(xe,U)}),xe})}var I=e(e.capture(p),e.capture(T([h,w,v]))).map(function(q,H){return q(H)}),X=e(x.rules.token("identifier","table"),e.capture(T([h,w]))).map(function(q){return oe.table(q)}),Z=r("b",oe.bold),C=r("i",oe.italic),O=r("u",oe.underline),j=r("strike",oe.strikethrough),K=r("all-caps",oe.allCaps),ge=r("small-caps",oe.smallCaps),we=r("comment-reference",oe.commentReference),Ee=e(x.rules.token("identifier","br"),e.cut(),x.rules.tokenOfType("open-square-bracket"),x.rules.token("identifier","type"),x.rules.tokenOfType("equals"),e.capture(Tt),x.rules.tokenOfType("close-square-bracket")).map(function(q){switch(q){case"line":return oe.lineBreak;case"page":return oe.pageBreak;case"column":return oe.columnBreak}});return x.rules.firstOf("element type",I,X,Z,C,O,j,K,ge,we,Ee)}function Po(e){return Tr(ha(),e)}function ha(){var e=x.rules.sequence.capture,r=x.rules.tokenOfType("whitespace"),u=x.rules.then(x.rules.optional(x.rules.sequence(x.rules.tokenOfType("colon"),x.rules.token("identifier","fresh"))),function(y){return y.map(function(){return!0}).valueOrElse(!1)}),s=x.rules.then(x.rules.optional(x.rules.sequence(x.rules.tokenOfType("colon"),x.rules.token("identifier","separator"),x.rules.tokenOfType("open-paren"),e(Tt),x.rules.tokenOfType("close-paren")).head()),function(y){return y.valueOrElse("")}),p=x.rules.oneOrMoreWithSeparator(va,x.rules.tokenOfType("choice")),h=x.rules.sequence(e(p),e(x.rules.zeroOrMore(ga)),e(u),e(s)).map(function(y,w,b,v){var T={},I={};return w.length>0&&(T.class=w.join(" ")),b&&(I.fresh=!0),v&&(I.separator=v),xt.element(y,T,I)});return x.rules.firstOf("html path",x.rules.then(x.rules.tokenOfType("bang"),function(){return xt.ignore}),x.rules.then(x.rules.zeroOrMoreWithSeparator(h,x.rules.sequence(r,x.rules.tokenOfType("gt"),r)),xt.elements))}var va=x.rules.then(x.rules.tokenOfType("identifier"),ya),No=x.rules.tokenOfType("integer"),Tt=x.rules.then(x.rules.tokenOfType("string"),ya),_o={n:`
`,r:"\r",t:"	"};function ya(e){return e.replace(/\\(.)/g,function(r,u){return _o[u]||u})}var ga=x.rules.sequence(x.rules.tokenOfType("dot"),x.rules.sequence.cut(),x.rules.sequence.capture(va)).head();function Tr(e,r){var u=ko(r),s=x.Parser(),p=s.parseTokens(e,u);return p.isSuccess()?ir.success(p.value()):new ir.Result(null,[ir.warning(Bo(r,p))])}function Bo(e,r){return"Did not understand this style mapping, so ignored it: "+e+`
`+r.errors().map(Co).join(`
`)}function Co(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var Mo=Io(),Mt={};Mt.readOptions=Fo;var ba=z.exports,$o=Mt._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],Ao=Mt._standardOptions={transformDocument:jo,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function Fo(e){return e=e||{},ba.extend({},Ao,e,{customStyleMap:Bn(e.styleMap),readStyleMap:function(){var r=this.customStyleMap;return this.includeEmbeddedStyleMap&&(r=r.concat(Bn(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(r=r.concat($o)),r}})}function Bn(e){return e?ba.isString(e)?e.split(`
`).map(function(r){return r.trim()}).filter(function(r){return r!==""&&r.charAt(0)!=="#"}):e:[]}function jo(e){return e}var wa={},Cn=Q,Ho=it;wa.openZip=Do;function Do(e){return e.arrayBuffer?Cn.resolve(Ho.openArrayBuffer(e.arrayBuffer)):Cn.reject(new Error("Could not find file in options"))}var lt={},Mn=z.exports;lt.paragraph=qo;lt.run=Wo;lt._elements=Ta;lt.getDescendantsOfType=Lo;lt.getDescendants=Ea;function qo(e){return xa("paragraph",e)}function Wo(e){return xa("run",e)}function xa(e,r){return Ta(function(u){return u.type===e?r(u):u})}function Ta(e){return function r(u){if(u.children){var s=Mn.map(u.children,r);u=Mn.extend(u,{children:s})}return e(u)}}function Lo(e,r){return Ea(e).filter(function(u){return u.type===r})}function Ea(e){var r=[];return Sa(e,function(u){r.push(u)}),r}function Sa(e,r){e.children&&e.children.forEach(function(u){Sa(u,r),r(u)})}var Xo={},Uo=Bt(),Vo=_t();Xo.element=zo;function zo(e){return function(r){return Vo.elementWithTag(Uo.element(e),[r])}}var Zo=z.exports,Ko=lr,Go=wr,Yo=xr.DocumentConverter,Jo=Ct.readStyle,Qo=Mt.readOptions,el=wa,tl=he.Result,hl=rl;function rl(e,r){return nl(e,r)}function nl(e,r){return r=Qo(r),el.openZip(e).tap(function(u){return Go.readStyleMap(u).then(function(s){r.embeddedStyleMap=s})}).then(function(u){return Ko.read(u,e).then(function(s){return s.map(r.transformDocument)}).then(function(s){return al(s,r)})})}function al(e,r){var u=ul(r.readStyleMap()),s=Zo.extend({},r,{styleMap:u.value}),p=new Yo(s);return e.flatMapThen(function(h){return u.flatMapThen(function(y){return p.convertToHtml(h)})})}function ul(e){return tl.combine((e||[]).map(Jo)).map(function(r){return r.filter(function(u){return!!u})})}export{hl as c};
