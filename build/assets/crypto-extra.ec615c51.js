import{a as S,c as i}from"./@ckeditor.245690c7.js";const E={},$=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),v=S($);var h={},m={};m.__esModule=!0;function K(r){return typeof r=="object"?JSON.stringify(r):String(r)}m.stringify=K;var M=i&&i.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};h.__esModule=!0;var N=M(v),B=m;function O(r,e){e===void 0&&(e={});for(var t=B.stringify(r),a=e.algorithm||"sha256",n=e.rounds||1,f=""+t+(e.salt||""),u=0;u<n;u++)f=N.default.createHash(a).update(f).digest("hex");return f}h.hash=O;var s={},T=i&&i.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};s.__esModule=!0;var o=T(v),A=m,g="aes-256-ctr",x="sha256";function b(r){var e=r||{}.ENCRYPTION_KEY;if(!e)throw new Error("No encryption key was found");var t=o.default.createHash("sha256").update(e).digest();return t}function D(r,e){if(r.length!==e.length)return!1;for(var t=0,a=0,n=r.length;a<n;a++)t|=r.charCodeAt(a)^e.charCodeAt(a);return t===0}function H(r,e){var t=Buffer.from(o.default.randomBytes(16)),a=Buffer.from(b(e)),n=o.default.createCipheriv(g,a,t);n.setEncoding("hex"),n.write(A.stringify(r)),n.end();var f=n.read(),u=o.default.createHmac(x,a);return u.update(f),u.update(t.toString("hex")),f+"$"+t.toString("hex")+"$"+u.digest("hex")}s.encrypt=H;function j(r,e){var t=r.split("$"),a=Buffer.from(t[1],"hex"),n=Buffer.from(b(e)),f=o.default.createHmac(x,n);if(f.update(t[0]),f.update(a.toString("hex")),!D(f.digest("hex"),t[2]))throw new Error("Encrypted payload has been tampered with");var u=o.default.createDecipheriv(g,n,a),w=u.update(t[0],"hex"),p=""+w+u.final();try{return JSON.parse(p)}catch{return p}}s.decrypt=j;var d={};d.__esModule=!0;var l=v;function C(r,e){if(r!==void 0&&r<=0)throw new Error("Random size must be a number above 0!");for(var t=l.randomBytes(r||10),a=e||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",f=0,u=t.length;f<u;f++)n+=a[t.readUInt8(f)%a.length];return n}d.randomString=C;function I(r){r===void 0&&(r={});var e=Number.MAX_SAFE_INTEGER;if(r.min=r.min||0,r.max=r.max||e,r.min<0||r.min>e-1||r.max<1||r.max>e)throw new Error("Limits must be between 0 and "+e);var t=l.randomBytes(16).toString("hex"),a=parseInt(t,16),n=a/3402823669209385e23;return Math.floor(n*(r.max-r.min+1)+r.min)}d.randomNumber=I;function L(r){if(r===void 0&&(r=64),r<2||r%2!==0)throw new TypeError("Length must be an even number above 0");return l.randomBytes(r/2).toString("hex")}d.randomKey=L;var R=i&&i.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},y=i&&i.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e},G=R(v),P=y(h),_=y(s),c=y(d);function J(r){console.log("crypto-extra: "+r)}var F=Object.assign(G.default,{hash:P.hash,encrypt:_.encrypt,decrypt:_.decrypt,randomString:c.randomString,randomNumber:c.randomNumber,randomKey:c.randomKey,generateKey:function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return J("`generateKey` has been renamed to `randomKey`"),c.randomKey.apply(c,r)}});export{F as d,v as r};
